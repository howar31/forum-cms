// This file is automatically generated by Keystone, do not modify it manually.
// Modify your Keystone config when you want to change this.

datasource postgresql {
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
  provider          = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                      Int        @id @default(autoincrement())
  name                    String     @default("")
  email                   String     @unique @default("")
  password                String
  role                    String
  isProtected             Boolean    @default(false)
  passwordUpdatedAt       DateTime?  @default(now())
  mustChangePassword      Boolean    @default(false)
  loginFailedAttempts     Int?       @default(0)
  accountLockedUntil      DateTime?
  lastFailedLoginAt       DateTime?
  passwordHistory         Json?
  passwordResetToken      String?
  passwordResetIssuedAt   DateTime?
  passwordResetRedeemedAt DateTime?
  from_Category_createdBy Category[] @relation("Category_createdBy")
  from_Category_updatedBy Category[] @relation("Category_updatedBy")
  from_Comment_createdBy  Comment[]  @relation("Comment_createdBy")
  from_Comment_updatedBy  Comment[]  @relation("Comment_updatedBy")
  from_Tag_createdBy      Tag[]      @relation("Tag_createdBy")
  from_Tag_updatedBy      Tag[]      @relation("Tag_updatedBy")
  from_Member_createdBy   Member[]   @relation("Member_createdBy")
  from_Member_updatedBy   Member[]   @relation("Member_updatedBy")
  from_Post_createdBy     Post[]     @relation("Post_createdBy")
  from_Post_updatedBy     Post[]     @relation("Post_updatedBy")
  from_Reaction_createdBy Reaction[] @relation("Reaction_createdBy")
  from_Reaction_updatedBy Reaction[] @relation("Reaction_updatedBy")
  from_Photo_createdBy    Photo[]    @relation("Photo_createdBy")
  from_Photo_updatedBy    Photo[]    @relation("Photo_updatedBy")
}

model Category {
  id                             Int       @id @default(autoincrement())
  title                          String    @default("")
  slug                           String    @unique @default("")
  summary                        String    @default("")
  priority                       Int       @default(0)
  createdAt                      DateTime?
  updatedAt                      DateTime?
  createdBy                      User?     @relation("Category_createdBy", fields: [createdById], references: [id])
  createdById                    Int?      @map("createdBy")
  updatedBy                      User?     @relation("Category_updatedBy", fields: [updatedById], references: [id])
  updatedById                    Int?      @map("updatedBy")
  from_Member_following_category Member[]  @relation("Member_following_category")

  @@index([createdById])
  @@index([updatedById])
}

model Comment {
  id                  Int               @id @default(autoincrement())
  member              Member?           @relation("Comment_member", fields: [memberId], references: [id])
  memberId            Int?              @map("member")
  content             String            @default("")
  content_zh          String            @default("")
  content_en          String            @default("")
  content_vi          String            @default("")
  content_id          String            @default("")
  content_th          String            @default("")
  post                Post?             @relation("Comment_post", fields: [postId], references: [id])
  postId              Int?              @map("post")
  reactions           Reaction[]        @relation("Reaction_comment")
  parent              Comment?          @relation("Comment_parent", fields: [parentId], references: [id])
  parentId            Int?              @map("parent")
  root                Comment?          @relation("Comment_root", fields: [rootId], references: [id])
  rootId              Int?              @map("root")
  like                Member[]          @relation("Comment_like")
  state               CommentStateType? @default(public)
  published_date      DateTime?
  is_edited           Boolean           @default(false)
  is_active           Boolean           @default(true)
  createdAt           DateTime?
  updatedAt           DateTime?
  createdBy           User?             @relation("Comment_createdBy", fields: [createdById], references: [id])
  createdById         Int?              @map("createdBy")
  updatedBy           User?             @relation("Comment_updatedBy", fields: [updatedById], references: [id])
  updatedById         Int?              @map("updatedBy")
  from_Comment_parent Comment[]         @relation("Comment_parent")
  from_Comment_root   Comment[]         @relation("Comment_root")

  @@index([memberId])
  @@index([postId])
  @@index([parentId])
  @@index([rootId])
  @@index([createdById])
  @@index([updatedById])
}

model Tag {
  id          Int       @id @default(autoincrement())
  name        String    @unique @default("")
  createdAt   DateTime?
  updatedAt   DateTime?
  createdBy   User?     @relation("Tag_createdBy", fields: [createdById], references: [id])
  createdById Int?      @map("createdBy")
  updatedBy   User?     @relation("Tag_updatedBy", fields: [updatedById], references: [id])
  updatedById Int?      @map("updatedBy")

  @@index([createdById])
  @@index([updatedById])
}

model Member {
  id                 Int                 @id @default(autoincrement())
  firebaseId         String              @unique @default("")
  customId           String              @unique @default("")
  name               String              @default("")
  nickname           String              @default("")
  avatar             String              @default("")
  intro              String              @default("")
  avatar_image       Photo?              @relation("Member_avatar_image", fields: [avatar_imageId], references: [id])
  avatar_imageId     Int?                @map("avatar_image")
  email              String              @unique @default("")
  is_active          Boolean             @default(true)
  verified           Boolean             @default(false)
  comment            Comment[]           @relation("Comment_member")
  member_like        Comment[]           @relation("Comment_like")
  posts              Post[]              @relation("Post_author")
  reactions          Reaction[]          @relation("Reaction_member")
  follower           Member[]            @relation("Member_follower")
  following          Member[]            @relation("Member_follower")
  block              Member[]            @relation("Member_block")
  blocked            Member[]            @relation("Member_block")
  following_category Category[]          @relation("Member_following_category")
  language           MemberLanguageType? @default(zh)
  createdAt          DateTime?
  updatedAt          DateTime?
  createdBy          User?               @relation("Member_createdBy", fields: [createdById], references: [id])
  createdById        Int?                @map("createdBy")
  updatedBy          User?               @relation("Member_updatedBy", fields: [updatedById], references: [id])
  updatedById        Int?                @map("updatedBy")

  @@index([avatar_imageId])
  @@index([createdById])
  @@index([updatedById])
}

model Post {
  id          Int        @id @default(autoincrement())
  title       String     @default("")
  content_zh  String     @default("")
  content_en  String     @default("")
  content_vi  String     @default("")
  content_id  String     @default("")
  content_th  String     @default("")
  author      Member?    @relation("Post_author", fields: [authorId], references: [id])
  authorId    Int?       @map("author")
  comments    Comment[]  @relation("Comment_post")
  reactions   Reaction[] @relation("Reaction_post")
  is_active   Boolean    @default(true)
  createdAt   DateTime?
  updatedAt   DateTime?
  createdBy   User?      @relation("Post_createdBy", fields: [createdById], references: [id])
  createdById Int?       @map("createdBy")
  updatedBy   User?      @relation("Post_updatedBy", fields: [updatedById], references: [id])
  updatedById Int?       @map("updatedBy")

  @@index([authorId])
  @@index([createdById])
  @@index([updatedById])
}

model Reaction {
  id          Int                 @id @default(autoincrement())
  member      Member?             @relation("Reaction_member", fields: [memberId], references: [id])
  memberId    Int?                @map("member")
  post        Post?               @relation("Reaction_post", fields: [postId], references: [id])
  postId      Int?                @map("post")
  comment     Comment?            @relation("Reaction_comment", fields: [commentId], references: [id])
  commentId   Int?                @map("comment")
  emotion     ReactionEmotionType
  createdAt   DateTime?
  updatedAt   DateTime?
  createdBy   User?               @relation("Reaction_createdBy", fields: [createdById], references: [id])
  createdById Int?                @map("createdBy")
  updatedBy   User?               @relation("Reaction_updatedBy", fields: [updatedById], references: [id])
  updatedById Int?                @map("updatedBy")

  @@index([memberId])
  @@index([postId])
  @@index([commentId])
  @@index([createdById])
  @@index([updatedById])
}

model Photo {
  id                       Int       @id @default(autoincrement())
  name                     String    @default("")
  file_id                  String?
  file_filesize            Int?
  file_width               Int?
  file_height              Int?
  file_extension           String?
  urlOriginal              String    @default("")
  createdAt                DateTime?
  updatedAt                DateTime?
  createdBy                User?     @relation("Photo_createdBy", fields: [createdById], references: [id])
  createdById              Int?      @map("createdBy")
  updatedBy                User?     @relation("Photo_updatedBy", fields: [updatedById], references: [id])
  updatedById              Int?      @map("updatedBy")
  from_Member_avatar_image Member[]  @relation("Member_avatar_image")

  @@index([createdById])
  @@index([updatedById])
  @@map("Image")
}

enum CommentStateType {
  public
  private
  friend
}

enum MemberLanguageType {
  zh
  en
  vi
  id
  th
}

enum ReactionEmotionType {
  happy
  angry
  surprise
  sad
}
